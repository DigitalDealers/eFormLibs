<form [formGroup]="form" *ngIf="config">
  <div *ngFor="let field of config?.fields">
    <didi-form-field [form]="form"
                     [field]="field"
                     [assetKey]="assetKey"
                     (setFieldValue)="setFieldValue($event)">
    </didi-form-field>

    <div *ngIf="toggleLogicSection(field)">
      <div *ngFor="let child of field?.children">
        <didi-form-field [form]="form"
                         [field]="child"
                         [assetKey]="assetKey"
                         (setFieldValue)="setFieldValue($event)">
        </didi-form-field>
      </div>
    </div>

    <div *ngIf="field.response.type !== 'table'">
      <div *ngFor="let child of field?.children">
        <didi-form-field [form]="form"
                         [field]="child"
                         [assetKey]="assetKey"
                         (setFieldValue)="setFieldValue($event)">
        </didi-form-field>
      </div>
    </div>

    <div *ngIf="field?.sections && field?.sections?.length">
      <div *ngFor="let section of field?.sections">
        <div
          *ngIf="
            showSection({
              condition: section.condition,
              value: section.value,
              fieldValue: form.get(field.controlName).value
            })
          "
        >
          <div *ngFor="let item of section?.items">
            <didi-form-field [form]="form"
                             [field]="item"
                             [assetKey]="assetKey"
                             (setFieldValue)="setFieldValue($event)">
            </didi-form-field>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="actions" *ngIf="!isPreview">
    <button type="button"
            *ngIf="prevFormId"
            mat-stroked-button
            color="primary"
            [disabled]="saving"
            (click)="backToMainForm()">
      Save & Back
    </button>

    <button type="button" mat-stroked-button color="warn" [disabled]="form.invalid || saving" (click)="submit()">
      Save & Close
    </button>
  </div>
</form>

<p class="form-id" *ngIf="config?.id">Form ID: {{ config.id }}</p>
